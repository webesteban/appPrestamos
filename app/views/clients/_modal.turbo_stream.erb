<turbo-frame id="modal">
  <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50" data-controller="modal">
    <div class="bg-white rounded-2xl shadow-xl w-full max-w-3xl p-6 relative">

      <!-- BotÃ³n para cerrar -->
      <button data-action="click->modal#close"
              class="absolute top-3 right-3 text-gray-600 hover:text-black text-2xl">
        &times;
      </button>

      <h2 class="text-2xl font-semibold mb-4"><%= client.full_name %></h2>

      <div class="space-y-4">

        <div>
          <h3 class="text-lg font-medium">ðŸ“Œ PrÃ©stamos vigentes</h3>
          <ul class="list-disc list-inside text-sm">
            <% client.loans.each do |loan| %>
              <li>
                <strong><%= number_to_currency(loan.amount) %></strong>
                â€” desde <%= l loan.created_at.to_date %>
              </li>
            <% end %>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-medium">ðŸ’µ Ãšltimos abonos</h3>
          <ul class="list-disc list-inside text-sm">
            <% Payment.joins(:loan).where(loans: { client_id: client.id }).order(created_at: :desc).limit(5).each do |payment| %>
              <li>
                <%= number_to_currency(payment.amount) %> a prÃ©stamo <%= payment.loan.id %> el <%= l payment.created_at.to_date %>
              </li>
            <% end %>
          </ul>
        </div>

        <div>
          <h3 class="text-lg font-medium">ðŸ“Š Resumen</h3>
          <ul class="list-inside text-sm">
            <% total_loan = client.loans.sum(:amount) %>
            <% total_payment = Payment.joins(:loan).where(loans: { client_id: client.id }).sum(:amount) %>
            <li>Total prestado: <%= number_to_currency(total_loan) %></li>
            <li>Total abonado: <%= number_to_currency(total_payment) %></li>
            <li class="font-bold">Saldo: <%= number_to_currency(total_loan - total_payment) %></li>
          </ul>
        </div>

      </div>
    </div>
  </div>
</turbo-frame>
